<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 450" width="800" height="450">
  <defs>
    <linearGradient id="purple-grad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#667eea"/>
      <stop offset="100%" style="stop-color:#764ba2"/>
    </linearGradient>
    <marker id="arrow-right" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#667eea"/>
    </marker>
    <marker id="arrow-left" markerWidth="10" markerHeight="7" refX="1" refY="3.5" orient="auto">
      <polygon points="10 0, 0 3.5, 10 7" fill="#a78bfa"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="800" height="450" fill="#0f172a"/>

  <!-- Column Headers -->
  <rect x="80" y="20" width="120" height="40" rx="8" fill="url(#purple-grad)"/>
  <text x="140" y="46" font-family="system-ui" font-size="14" font-weight="600" fill="white" text-anchor="middle">iOS App</text>

  <rect x="340" y="20" width="120" height="40" rx="8" fill="#3b82f6"/>
  <text x="400" y="46" font-family="system-ui" font-size="14" font-weight="600" fill="white" text-anchor="middle">Backend</text>

  <rect x="600" y="20" width="120" height="40" rx="8" fill="#10b981"/>
  <text x="660" y="46" font-family="system-ui" font-size="14" font-weight="600" fill="white" text-anchor="middle">LLM</text>

  <!-- Vertical Lines -->
  <line x1="140" y1="70" x2="140" y2="420" stroke="#334155" stroke-width="2"/>
  <line x1="400" y1="70" x2="400" y2="420" stroke="#334155" stroke-width="2"/>
  <line x1="660" y1="70" x2="660" y2="420" stroke="#334155" stroke-width="2"/>

  <!-- Step 1: User sends message -->
  <circle cx="140" cy="100" r="6" fill="#667eea"/>
  <line x1="146" y1="100" x2="394" y2="100" stroke="#667eea" stroke-width="2" marker-end="url(#arrow-right)"/>
  <rect x="200" y="82" width="140" height="24" rx="4" fill="#1e293b"/>
  <text x="270" y="99" font-family="monospace" font-size="11" fill="#e2e8f0" text-anchor="middle">SSE /v1/chat/stream</text>
  <text x="45" y="104" font-family="system-ui" font-size="10" fill="#64748b">1</text>

  <!-- Step 2: Backend calls LLM -->
  <circle cx="400" cy="140" r="6" fill="#3b82f6"/>
  <line x1="406" y1="140" x2="654" y2="140" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrow-right)"/>
  <rect x="480" y="122" width="100" height="24" rx="4" fill="#1e293b"/>
  <text x="530" y="139" font-family="system-ui" font-size="11" fill="#e2e8f0" text-anchor="middle">LangGraph</text>
  <text x="45" y="144" font-family="system-ui" font-size="10" fill="#64748b">2</text>

  <!-- Step 3: LLM requests tool -->
  <circle cx="660" cy="180" r="6" fill="#10b981"/>
  <line x1="654" y1="180" x2="406" y2="180" stroke="#a78bfa" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrow-left)"/>
  <rect x="480" y="162" width="100" height="24" rx="4" fill="#1e293b"/>
  <text x="530" y="179" font-family="system-ui" font-size="11" fill="#e2e8f0" text-anchor="middle">tool_use</text>
  <text x="45" y="184" font-family="system-ui" font-size="10" fill="#64748b">3</text>

  <!-- Step 4: Backend sends to iOS -->
  <circle cx="400" cy="220" r="6" fill="#3b82f6"/>
  <line x1="394" y1="220" x2="146" y2="220" stroke="#a78bfa" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrow-left)"/>
  <rect x="200" y="202" width="140" height="24" rx="4" fill="#1e293b"/>
  <text x="270" y="219" font-family="system-ui" font-size="11" fill="#e2e8f0" text-anchor="middle">event: tool_use</text>
  <text x="45" y="224" font-family="system-ui" font-size="10" fill="#64748b">4</text>

  <!-- Step 5: iOS executes tool -->
  <rect x="90" y="250" width="100" height="40" rx="6" fill="#334155" stroke="#667eea" stroke-width="1"/>
  <text x="140" y="275" font-family="system-ui" font-size="11" fill="#e2e8f0" text-anchor="middle">Execute tool</text>
  <text x="45" y="274" font-family="system-ui" font-size="10" fill="#64748b">5</text>

  <!-- Step 6: iOS sends result -->
  <circle cx="140" cy="320" r="6" fill="#667eea"/>
  <line x1="146" y1="320" x2="394" y2="320" stroke="#667eea" stroke-width="2" marker-end="url(#arrow-right)"/>
  <rect x="200" y="302" width="140" height="24" rx="4" fill="#1e293b"/>
  <text x="270" y="319" font-family="monospace" font-size="11" fill="#e2e8f0" text-anchor="middle">POST /v1/tool-result</text>
  <text x="45" y="324" font-family="system-ui" font-size="10" fill="#64748b">6</text>

  <!-- Step 7: Backend continues -->
  <circle cx="400" cy="360" r="6" fill="#3b82f6"/>
  <line x1="406" y1="360" x2="654" y2="360" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrow-right)"/>
  <rect x="480" y="342" width="100" height="24" rx="4" fill="#1e293b"/>
  <text x="530" y="359" font-family="system-ui" font-size="11" fill="#e2e8f0" text-anchor="middle">continue</text>
  <text x="45" y="364" font-family="system-ui" font-size="10" fill="#64748b">7</text>

  <!-- Step 8: Final response -->
  <circle cx="660" cy="400" r="6" fill="#10b981"/>
  <line x1="654" y1="400" x2="146" y2="400" stroke="#a78bfa" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrow-left)"/>
  <rect x="340" y="382" width="120" height="24" rx="4" fill="#1e293b"/>
  <text x="400" y="399" font-family="system-ui" font-size="11" fill="#e2e8f0" text-anchor="middle">message_stop</text>
  <text x="45" y="404" font-family="system-ui" font-size="10" fill="#64748b">8</text>

  <!-- Legend -->
  <line x1="600" y1="430" x2="640" y2="430" stroke="#667eea" stroke-width="2"/>
  <text x="650" y="434" font-family="system-ui" font-size="10" fill="#94a3b8">Request</text>

  <line x1="710" y1="430" x2="750" y2="430" stroke="#a78bfa" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="760" y="434" font-family="system-ui" font-size="10" fill="#94a3b8">Response</text>
</svg>
